<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/kogan.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Kogan Code Test</title>
</head>
<body>
<!-- title part -->
<div class="centered">
    <header>
        <h1>Average Cubic Weight</h1>
    </header>

<!-- Calculate Part -->
    <div>
        <button onclick='getObjects();'>Calculate</button>
        <button onclick="window.location.reload();">Reset</button>
    </div>
<!-- Result display -->
    <div id="entire">
        <p>The average cubic weight for air conditioning unit(s):
        </p>
        <h2><span id="kgWeight"> ____ </span> kg = <span id="gWeight"> ____ </span> g</h2>
    </div>
<!-- social media -->
    <div>
        <span class="sc"><a href="https://www.linkedin.com/in/nelly-dai/" class="fa fa-linkedin" 
        target="_blank"></a></span>
        <span class="sc"><a href="https://github.com/smartnelly" class="fa fa-github" target="_blank"></a></span>
        <span class="sc"><a href="https://twitter.com/Nelly_qiongdai" class="fa fa-twitter" target="_blank"></a></span>
        <span class="sc"><a href="mailto:daiqiong524@outlook.com" class="fa fa-envelope"></a></span>
        
    </div>
    <script>
        function getObjects() {
                //HTTP Request
                const url =
                    "http://wp8m3he1wt.s3-website-ap-southeast-2.amazonaws.com/api/products/1";
                const xhr = new XMLHttpRequest();
                xhr.open("GET", url, true);
                xhr.setRequestHeader("accept", "application/json");
                xhr.onload = () => {
                    let data = JSON.parse(xhr.responseText);
                    console.log(data);
                    //Initialising variables for number of air conditioning units and total cubic weight
                    let totalUnits = 0;
                    let totalCubicWeight = 0;
                    //Iterate object array
                    data.objects.forEach((obj) => {
                        if (obj.category == "Air Conditioners") {
                            //Number of air conditioners incremented
                            totalUnits += 1;
                            const cubicMetres =
                                (obj.size.width / 100) *
                                (obj.size.length / 100) *
                                (obj.size.height / 100);
                            totalCubicWeight += cubicMetres * 250;
                        }
                    });
                    //if no Air Conditioners
                    if (totalUnits == 0) {
                        alert("No detected Air Conditioning units for this endpoint.");
                    }
                    //Final output and results displayed, with the average calculated to one decimal place
                    const output = (totalCubicWeight / totalUnits).toFixed(3);
                    document.getElementById("kgWeight").innerHTML = output;
                    document.getElementById("gWeight").innerHTML = output * 1000;
                };
                xhr.send(null);
            }

    </script>
</div>
</body>
</html>